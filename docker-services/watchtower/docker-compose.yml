services:
  watchtower:
    image: containrrr/watchtower:latest
    container_name: watchtower
    restart: unless-stopped

    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
      - /srv/docker-data/watchtower:/config

    environment:
      - DOCKER_API_VERSION=1.44 # Force compatible API version
      - WATCHTOWER_SCHEDULE=0 0 2 * * 0,3,5
      - WATCHTOWER_CLEANUP=true
      - WATCHTOWER_INCLUDE_STOPPED=true
      - WATCHTOWER_ROLLING_RESTART=true
      - WATCHTOWER_TIMEOUT=60s
      - WATCHTOWER_NOTIFICATIONS_LEVEL=info
      - WATCHTOWER_LOG_LEVEL=info
      - TZ=Asia/Kolkata

    labels:
      - "com.centurylinklabs.watchtower.enable=true"

# ============================================
# HOW TO CONTROL UPDATES PER CONTAINER
# ============================================
#
# Add these labels to containers you want to control:
#
# 1. DISABLE updates for a specific container:
#    labels:
#      - "com.centurylinklabs.watchtower.enable=false"
#
# 2. Enable updates (default behavior):
#    labels:
#      - "com.centurylinklabs.watchtower.enable=true"
#
# 3. Set custom stop timeout:
#    labels:
#      - "com.centurylinklabs.watchtower.stop-timeout=30s"
#
# Example - Add to your Jellyfin service:
#
# services:
#   jellyfin:
#     image: jellyfin/jellyfin:latest
#     labels:
#       - "com.centurylinklabs.watchtower.enable=true"
#       - "com.centurylinklabs.watchtower.stop-timeout=120s"
#
# ============================================
# SCHEDULE FORMAT EXAMPLES
# ============================================
#
# Every day at 4 AM:
# WATCHTOWER_SCHEDULE=0 0 4 * * *
#
# Every Sunday at 3 AM:
# WATCHTOWER_SCHEDULE=0 0 3 * * 0
#
# Every 6 hours:
# WATCHTOWER_SCHEDULE=0 0 */6 * * *
#
# Every Monday and Friday at 2 AM:
# WATCHTOWER_SCHEDULE=0 0 2 * * 1,5
#
# ============================================
